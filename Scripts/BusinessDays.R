# Standarized program for working with business days at Jackson -pw
# Fri Oct 11 12:20:09 2019 ------------------------------

library(bizdays)
library(tidyverse)

JACKHOL <- as.Date(c(
  "2013-01-01", "2013-01-21", "2013-02-18", "2013-05-18", "2013-07-04", "2013-09-02", "2013-11-28", "2013-12-25", "2014-01-01", "2014-01-20", "2014-02-17", "2014-05-26", "2014-07-04", "2014-09-01",
  "2014-11-27", "2014-12-25", "2015-01-01", "2015-01-19", "2015-02-16", "2015-04-03", "2015-05-25", "2015-07-03", "2015-09-07", "2015-11-26", "2015-12-25", "2016-01-01", "2016-01-18", "2016-02-15",
  "2016-03-25", "2016-05-30", "2016-07-04", "2016-09-05", "2016-11-24", "2016-12-26", "2017-01-02", "2017-01-16", "2017-02-20", "2017-04-14", "2017-05-29", "2017-07-04", "2017-09-04", "2017-11-23",
  "2017-12-25", "2018-01-01", "2018-01-15", "2018-02-19", "2018-02-28", "2018-03-30", "2018-07-04", "2018-09-03", "2018-11-22", "2018-12-25", "2019-01-01", "2019-01-21", "2019-02-18", "2019-04-19",
  "2019-05-27", "2019-07-04", "2019-09-02", "2019-11-28", "2019-12-25", "2020-01-01", "2020-01-20", "2020-02-17", "2020-04-10", "2020-05-25", "2020-07-03", "2020-09-07", "2020-11-26", "2020-12-25",
  "2021-01-01", "2021-01-18", "2021-02-15", "2021-04-02", "2021-05-31", "2021-07-05", "2021-09-06", "2021-11-25", "2021-12-24", "2021-12-31", "2022-01-17", "2022-02-21", "2022-04-15", "2022-05-30",
  "2022-07-04", "2022-09-05", "2022-11-24", "2022-12-26", "2023-01-02", "2023-01-16", "2023-02-20", "2023-04-07", "2023-05-29", "2023-07-04", "2023-09-04", "2023-11-23", "2023-12-25"
))
cal <- create.calendar(weekdays = c("saturday", "sunday"), holidays = JACKHOL, name = "Actual")

Today <- Sys.Date()
LastBusDay <- add.bizdays(Today, -1, cal)

BusDayOut <- function(Number){
  tibble(
    date = seq(
      lubridate::floor_date(Sys.Date(),"month"), 
      lubridate::ceiling_date(Sys.Date(),"month") - 1, 
      by = "day"),
    biz = is.bizday(date, cal)
  ) %>%
    filter(biz == TRUE) %>%
    mutate(BizNum = row_number()) %>%
    filter(BizNum == Number) %>%
    pull(date)
}

# FirstBusDay <- BusDayOut(1)
# BusDayOut(11)
